<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Quiz Implementation (JSON)</title>

    <meta name="viewport" content="width=device-width,initial-scale=1.0, shrink-to-fit=no" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="../../css/page.css">
</head>

<body>

    <!-- Top Navigation -->
    <header id="header">
        <nav class="navbar navbar-inverse">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#collapsemenu" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="../../index.html" class="navbar-brand">Personal Notes</a>
                </div>

                <div class="collapse navbar-collapse" id="collapsemenu">
                    <ul class="nav navbar-nav">

                        <!-- GAME DEVELOMENT -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Game Development <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- CONCEPTS -->
                                <li><a href="../Categories/concepts.html">Concepts <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- ENGINE -->
                                <li><a href="../Categories/engine.html">Engine <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- IMPLEMENTATIONS -->
                                <li><a href="../Categories/implementations.html">Implementations <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                        <!-- PROGRAMMING -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Programming <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- LANGUAGES -->
                                <li><a href="../../code/Categories/languages.html">Languages <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- ALGORITHMS -->
                                <li><a href="../../code/Categories/algorithms.html">Algorithms <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- PROBLEMS -->
                                <li><a href="../../code/Categories/problems.html">Problems <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- RANDOM -->
                                <li><a href="../../code/Categories/random.html">Random <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                        <!-- GABE DEVELOPMENT -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Gabe Development <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- FITNESS PAGE -->
                                <li><a href="../../gabe/Categories/fitness.html">Fitness <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- STYLE & GROOMING PAGE -->
                                <li><a href="../../gabe/Categories/style.html">Style <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- FINANCE PAGE -->
                                <li><a href="../../gabe/Categories/finance.html">Finance <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- PHILOSOPHY PAGE -->
                                <li><a href="../../gabe/Categories/philosophy.html">Philosophy <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                    </ul>
                </div>

            </div>
        </nav>
    </header>

    <!-------------------------------------------------------------------------->

    <!-- Side Navigation -->
    <aside id="side-nav">
        <ul>
          <li><a href="#header">Top</a></li>
          <li class="separator"></li>
          <li><a href="#0">Setup</a></li>
          <li><a href="#1">Data Classes</a></li>
          <li><a href="#2">Menu Screen</a></li>
          <li><a href="#3">Game UI</a></li>
          <li><a href="#4">Answer Button</a></li>
          <li><a href="#5">Displaying Questions</a></li>
          <li><a href="#6">Ending the Game</a></li>
        </ul>
    </aside>

    <!-- Main -->
    <main>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1 id="title">Quiz Implementation (JSON)</h1>

                    <div class="jumbotron heliList">
                        <h2>Index</h2>
                        <ul>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#0">Setup</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#1'>Data Classes</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#2'>Menu Screen</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#3'>Game UI</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#4'>Answer Button</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#5'>Displaying Questions</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#6'>Ending the Game</a>
                                </p>
                            </li>
                        </ul>
                    </div>

<div class="jumbotron col-md-12 heliList" id="0">
    <h2>Setup</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            <b>Game</b> This game is a simple quiz game. 
            <br> &nbsp; &bull; It is graphically simple.
            <br> &nbsp; &bull; Goal is to separate <i>game logic</i> from your <i>data</i>.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Create a <b>Scenes</b>, <b>Scripts</b>, and <b>Prefabs</b> folder.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Delete the Camera from the initial scene and save the scene as <b>Persistent</b>.
            <p><span class='glyphicon-remove'></span>Create a new scene as <b>MenuScreen</b>.</p>
            <p><span class='glyphicon-remove'></span>Create a enw scene as <b>Game</b>.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            In the <i>Persistent</i> scene, create an <i>empty</i> object called <b>"Data Controller"</b>.
            <p><span class='glyphicon-remove'></span>Create <i>two</i> new scripts called <b>DataController</b> and <b>AnswerData</b>.</p>
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='1'>
    <h2>Data Classes</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Answer Data</h3>
            <pre>
            <span class='glyphicon-remove'></span>[System.Serializable]
            public class AnswerData {
                public string answerText;
                public bool isCorrect;
            }
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Question Data</h3>
            <pre>
            <span class='glyphicon-remove'></span>[System.Serializable]
            public class QuestionData {
                public string questionText;
                public AnswerData[] answers;
            }
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Round Data</h3>
            <p><span class='glyphicon-remove'></span>Create a new script <b>RoundData</b>.</p>
            <pre>
            <span class='glyphicon-remove'></span>[System.Serializable]
            public class RoundData {
                public string name;
                public int timeLimitInSeconds;
                public int pointsAddedForCorrectAnswer;
                public QuestionData[] questions;
            }
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Data Controller</h3>
            <pre>
            <span class='glyphicon-remove'></span>//using UnityEngine.SceneManagement;

            public class DataController : MonoBehaviour {
                public RoundData[] allRoundData;

                void Start() {
                    DontDestroyOnLoad(gameObject);

                    SceneManager.LoadScene("MenuScreen");
                }

                public RoundData GetCurrentRoundData() {
                    return allRoundData[0];
                }
            }
            </pre>
            <p><span class='glyphicon-remove'></span>Make the size of the <i>allRoundData</i> array 1.</p>
            <p><span class='glyphicon-remove'></span>Set the round name to Round Zero, the Time limit to 30 sec, and the points added for correct to 10.</p>
            <p><span class='glyphicon-remove'></span>Set the size of the questions array to 3.</p>
            <p><span class='glyphicon-remove'></span>The first question is: "Are lions carnivores?", The answer size is 2, with Yes and No. Yes being correct.</p>
            <p><span class='glyphicon-remove'></span>The second questions is: "Where do mice live?", The answer size is 3, with On the moon, On land, and On sea. On land being correct.</p>
            <p><span class='glyphicon-remove'></span>The third question is: "What do frogs eat?", The answer size being 2, with Flies and Pizzas. Flies being correct.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Scenes</h3>
            <p><span class='glyphicon-remove'></span>Add the Persistent scene, MenuScreen scene, and Game scene to the build settings; in that order.</p>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='2'>
    <h2>Menu Screen</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            Head to the Menu Scene.
            <p><span class='glyphicon-remove'></span>Create a UI Button item. Set the text to <i>Start Game</i>. Anchor and position Button to center.</p>
            <p><span class='glyphicon-remove'></span>Add a Text item to the Canvas. Set size to 40 and position and enlarge to right above the button.</p>
            <p><span class='glyphicon-remove'></span>Create an empty GO called <i>"MenuScreenController"</i>. Add a script with the same name.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <pre>
            <span class='glyphicon-remove'></span>//using UnityEngine.SceneManagement;

            public class MenuScreenController : MonoBehaviour {
                public void StartGame() {
                    SceneManager.LoadScene("Game");
                }
            }
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            On the <i>Star Game</i> button, add an On Click event by clicking the add button.
            <p><span class='glyphicon-remove'></span>Drag the <i>MenuScreenController</i> object onto the event and add the StartGame() function.</p>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='3'>
    <h2>Game UI</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            Head to the Game Scene.
            <p><span class='glyphicon-remove'></span>Add a UI Panel. Set the Color to turquoise and set alpha to full opaque (255). Name it <b>Question Panel</b></p>
            <p><span class='glyphicon-remove'></span>Add a Text Component named "QuestionDisplay" as a child of the Question Panel. Set size to 32. Set to full stretch from left to right. Set Left an Right to 32 to bring the transform in a bit. Set anchors to minX: 0, minY: 0.5, maxX: 1, maxY: 0.75, pivotX: 0.5, pivotY: 0.5</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            Add another UI Panel named "AnswerPanel" as a sibling to Question Panel. Completely remove the Image component. Resize to a comfortable size below the Question Display
            <p><span class='glyphicon-remove'></span>Add a Vertical Layout Group to the Answer Panel. Add a Button as a child of the Answer Panel called AnswerButton. Add more buttons to test the Vertical Layout Group. Make it's text size 20</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            Add another panel called "UI" as a child of the canvas. Remove the Image component. Position at the top of the Canvas with default 160 width, and 30 height.
            <p><span class='glyphicon-remove'></span>Add a Text UI called "TimeDisplay" with 20pt font and align to the upper right. Set text to "Time: 0". Repeat this step with a "ScoreDisplay" text with text saying "Score: 0".</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            Duplicate the QuestionPanel and rename as "RoundOverPanel". Delete the Answer Panel. Center the Question Display text and make text say "ROUND OVER". Change color of this panel to darker purple. Add a Button called "Menu" and place in the middle with "Menu" as text. Make sure this panel is placed over the UI system. Set the panel to deactivated.
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            Add two empty object to the this Game scene called "GameController" and "AnswerButtonObjectPool".
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='4'>
    <h2>Answer Button</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            Create a new script called "SimpleObjectPool". Add this to the AnswerButtonObjectPool object.
            <pre>
            <span class='glyphicon-remove'></span>// A very simple object pooling class
            public class SimpleObjectPool : MonoBehaviour
            {
                // the prefab that this object pool returns instances of
                public GameObject prefab;
                // collection of currently inactive instances of the prefab
                private Stack&lt;GameObject> inactiveInstances = new Stack&lt;GameObject>();
            
                // Returns an instance of the prefab
                public GameObject GetObject() 
                {
                    GameObject spawnedGameObject;
            
                    // if there is an inactive instance of the prefab ready to return, return that
                    if (inactiveInstances.Count > 0) 
                    {
                        // remove the instance from teh collection of inactive instances
                        spawnedGameObject = inactiveInstances.Pop();
                    }
                    // otherwise, create a new instance
                    else 
                    {
                        spawnedGameObject = (GameObject)GameObject.Instantiate(prefab);
            
                        // add the PooledObject component to the prefab so we know it came from this pool
                        PooledObject pooledObject = spawnedGameObject.AddComponent&lt;PooledObject>();
                        pooledObject.pool = this;
                    }
            
                    // enable the instance
                    spawnedGameObject.SetActive(true);
            
                    // return a reference to the instance
                    return spawnedGameObject;
                }
            
                // Return an instance of the prefab to the pool
                public void ReturnObject(GameObject toReturn) 
                {
                    PooledObject pooledObject = toReturn.GetComponent&lt;PooledObject>();
            
                    // if the instance came from this pool, return it to the pool
                    if(pooledObject != null &amp;&amp; pooledObject.pool == this)
                    {
                        // disable the instance
                        toReturn.SetActive(false);
            
                        // add the instance to the collection of inactive instances
                        inactiveInstances.Push(toReturn);
                    }
                    // otherwise, just destroy it
                    else
                    {
                        Debug.LogWarning(toReturn.name + " was returned to a pool it wasn't spawned from! Destroying.");
                        Destroy(toReturn);
                    }
                }
            }
            
            // a component that simply identifies the pool that a GameObject came from
            public class PooledObject : MonoBehaviour
            {
                public SimpleObjectPool pool;
            }
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            Now make a prefab with the AnswerButton in the Canvas. Add a script to it called "AnswerButton".
            <pre>
            <span class='glyphicon-remove'></span>public class AnswerButton : MonoBehaviour {

                public Text answerText;

                private AnswerData answerData;
                //private GameController gameController;

                void Start() {
                    //gameController = FindObjectOfType&lt;GameController>();
                }

                public void Setup(AnswerData data) {
                    answerData = data;
                    answerData.text = answerData.answerText;
                }

                /* 
                public void HandleClick() {
                    gameController.AnswerButtonClicked(answerData.isCorrect);
                }

                */
            }
            </pre>
            <p><span class='glyphicon-remove'></span>Drag the Text under the AnswerButton into the public text field.</p>
            <p><span class='glyphicon-remove'></span>Delete the AnswerButton from the scene as it's now a prefab.</p>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='5'>
    <h2>Displaying Questions</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            Add a script called "GameController" to the Game Controller object.
            <pre>
            <span class='glyphicon-remove'></span>//using UnityEngine.UI, UnityEngine.SceneManagement, System.Collections.Generic;

            public class GameController : MonoBehaviour {

                public Text questionDisplayText;
                public Text scoreDisplayText;
                public Text timeRemainingDisplayText;
                public SimplejObjectPool answerButtonObjectPool;
                public Transform answerButtonParent;
                public GameObject questionDisplay;
                public GameObject roundEndDisplay;

                private DataController dataController;
                private RoundData currentRoundData;
                private QuestionData[] questionPool;

                private bool isRoundActive;
                private float timeRemaining;
                private int questionIndex;
                private int playerScore;
                private List&lt;GameObject> answerButtonGameObjects = new List&lt;GameObject>();

                void Start() {
                    dataController = FindObjectOfType&lt;DataController>();
                    currentRoundData = dataController.GetRoundData();
                    questionPool = currentRoundData.questions;
                    timeRemaining = currentRoundData.timeLimitInSeconds;
                    UpdateTimeRemainingDisplay();

                    playerScore = 0;
                    questionIndex = 0;

                    ShowQuestion();
                    isRoundActive = true;
                }

                void Update() {
                    if(isRoundActive) {
                        timeRemaining -= Time.deltaTime;
                        UpdateTimeRemainingDisplay();
                    }

                    if(timeRemaining &lt;= 0f) {
                        EndRound();
                    }
                }

                private void UpdateTimeRemainingDisplay() {
                    timeRemainingDisplayText.text = "Time: " + Mathf.Round(timeRemaining).ToString();
                }

                private void ShowQuestion() {
                    RemoveAnswerButtons();
                    QuestionData questionData = questionPool[questionIndex];
                    questionDisplayText.text = questionData.questionDisplayText;

                    for(int i = 0; i &lt; questionData.answers.Length; i++) {
                        GameObject answerButtonGameObject = answerButtonObjectPool.GetObject();
                        answerButtonGameObjects.Add(answerButtonGameObject);
                        answerButtonGameObject.transform.SetParent(answerButtonParent);

                        AnswerButton answerButton = answerButtonGameObject.GetComponent&lt;AnswerButton>();
                        answerButton.Setup(questionData.answers[i]);
                    }
                }

                private void RemoveAnswerButtons() {
                    while(answerButtonGameObjects.Count > 0) {
                        answerButtonObjectPool.ReturnObject(answerButtonGameObjects[0]);
                        answerButtonGameObjects.RemoveAt(0);
                    }
                }

                public void AnswerButtonClicked(bool isCorrect) {
                    if(isCorrect) {
                        playerScore += currentRoundData.pointsAddedForCorrectAnswer;
                        scoreDisplayText.text = "Score: " + player.Score.ToString();
                    }

                    if(questionPool.Length > questionIndex + 1) {
                        questionIndex++;
                        ShowQuestion();
                    } else {
                        EndRound()
                    }
                }

                public void EndRound() {
                    isRoundActive = false;

                    questionDisplay.SetActive(false);
                    roundEndDisplay.SetActive(true);
                }

                public void ReturnToMenu() {
                    SceneManager.LoadScene("MenuScreen");
                }
            }
            </pre>
            <p><span class='glyphicon-remove'></span>QuestionDisplay (Text) -> Question Display Text / ScoreDisplay (Text) -> Score Display Text / TimeDisplay (Text) -> Time Remaining Display / AnswerButtonObjectPool (SimpleObjectPool) -> Answer Button Object Pool / AnswerPanel (Rect Transform) -> Answer Button Parent / QuestionPanel -> Question Display / RoundOverPanel -> Round End Display</p>
            <p><span class='glyphicon-remove'></span>Go back to the AnswerButton prefab so you can call the AnswerButton.HandleClick event in the inspector.</p>
            <p><span class='glyphicon-remove'></span>Go to the MenuButton under the RoundOverPanel and add an OnClick event. Drag in the Game Controller and select the ReturnToMenu() function.</p>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='6'>
    <h2>Ending the Game</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            Should be ready to test?
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

                    <!-------------------------------------->
                </div>
            </div>
    </main>

    <!-------------------------------------------------------------------------->

    <!-- FOOTER -->
    <footer class="navbar navbar-inverse navbar-fixed-bottom">
        <nav>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <ul>
                            <li>&copy; 2017 <a href="http://www.gabedeyo.com">Gabe Deyo</a></li>
                            <li>|</li>
                            <li><a href="mailto:gabedeyo@gmail.com?subject=Notes">gabedeyo@gmail.com</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </footer>

    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="../../js/selection.js" charset="utf-8"></script>
</body>

</html>