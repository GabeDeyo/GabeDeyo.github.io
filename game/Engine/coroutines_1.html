<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Page Template</title>

    <meta name="viewport" content="width=device-width,initial-scale=1.0, shrink-to-fit=no" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="../../css/page.css">
</head>

<body>

    <!-- Top Navigation -->
    <header>
        <nav class="navbar navbar-inverse">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#collapsemenu" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="../../index.html" class="navbar-brand">Personal Notes</a>
                </div>

                <div class="collapse navbar-collapse" id="collapsemenu">
                    <ul class="nav navbar-nav">

                        <!-- GAME DEVELOMENT -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Game Development <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- CONCEPTS -->
                                <li><a href="../Categories/concepts.html">Concepts <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- ENGINE -->
                                <li><a href="../Categories/engine.html">Engine <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- IMPLEMENTATIONS -->
                                <li><a href="../Categories/implementations.html">Implementations <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                        <!-- PROGRAMMING -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Programming <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- LANGUAGES -->
                                <li><a href="../../code/Categories/languages.html">Languages <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- ALGORITHMS -->
                                <li><a href="../../code/Categories/algorithms.html">Algorithms <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- PROBLEMS -->
                                <li><a href="../../code/Categories/problems.html">Problems <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- RANDOM -->
                                <li><a href="../../code/Categories/random.html">Random <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                        <!-- GABE DEVELOPMENT -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Gabe Development <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- FITNESS PAGE -->
                                <li><a href="../../gabe/Categories/fitness.html">Fitness <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- STYLE & GROOMING PAGE -->
                                <li><a href="../../gabe/Categories/style.html">Style <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- FINANCE PAGE -->
                                <li><a href="../../gabe/Categories/finance.html">Finance <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- PHILOSOPHY PAGE -->
                                <li><a href="../../gabe/Categories/philosophy.html">Philosophy <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                    </ul>
                </div>

            </div>
        </nav>
    </header>

    <!-------------------------------------------------------------------------->

    <!-- MAIN -->
    <main>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1 id="title">Page Template</h1>

                    <aside>
                        <button type="button" class="btn btn-default" name="button" id="selectAll">Select All</button>
                        <button type="button" class="btn btn-default" name="button" id="clearAll">Clear All</button>
                    </aside>

                    <div class="jumbotron heliList">
                        <h2>Index</h2>
                        <ul>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#questions">Questions</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#coroutine">Coroutine</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#using-a-coroutine">Using a Coroutine</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#why-coroutines">Why Coroutines</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#where-and-when">Where &amp; When</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#whats-new">Whats New</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#caution">Caution</a>
                                </p>
                            </li>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#comments">Important Comments</a>
                                </p>
                            </li>
                        </ul>
                    </div>

<div class="jumbotron col-md-12 heliList" id="questions">
    <h2>Questions</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            <b>Why should I have to use the update function for EVERYTHING?</b>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            <b>What are coroutines and how can I use them?</b>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            <b>What are the best cases to use a Coroutine?</b>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            <b>How can I sequence my game flow?</b>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Many people ask themselves "What's the deal with not using Update? There can't be that much wrong with it." Well imagine a case where you have 1000's of GameObject and all of which have some execution in their Update() function. Updates are called under any circumstances (given that they are defined). They may not seem so heavy at first but they can really add up. We need to look at the cases where Update is too much and should not handle the situation.
            <br>This is where Coroutines come in.
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="coroutine">
    <h2>Coroutine</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            What is a Coroutine?
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            As stated by Unity Docs: <b>A coroutine is like a function that has the ability to pause execution and return control to Unity but then to continue where it left off on the following frame.</b>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            In simpler words: <b>It is a special type of function used in Unity to stop the execution until sometime or certain condition is met, and continues from where it had left off.</b>
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="using-a-coroutine">
    <h2>Using a Coroutine</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            Firstly, remember one thing, don't forget to use <i>IEnumerator</i> as a data type of function and second is, we can only start a <i>Coroutine</i> with a function called <b>StartCoroutine(Coroutine).</b> Before going further I recommend you have a look at WaitForSecond, and Yield, so it will be easier to understand.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            As stated in Unity Docs: <b>It is essentially a funciton declared with a return type of IEnumerator and with the yield return statement included somewhere in the body. The yield return line is the point at which execution will pause and be resumed the following frame.</b>
            <br>Here, Yield is like return type statement where execution gets stopped and goes to the function where it was invoked. After execution, it comes back to a point from where it left the execution and starts execution next lines.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Let's consider an example of fading an image in specific time.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            1. Take a Canvas and a Panel inside it.
            <br>2. Create an empty C# script and name it FadeEffect
            <br>3. Assign it to panel give it a try.
            <pre>
            <span class="glyphicon-remove"></span>public class FadeEffect : MonoBehavior {
                public Image image;

                void Update(){
                    if(Input.GetKeyDown(KeyCode.F)){
                        StartCoroutine(PerformFading(0.5f));
                    }
                }

                IEnumerator PerformFading(float time) {
                    float i = 0;
                    float rate = 1 / time;

                    while(i < 1){
                        image.color = new color(0.0f, 0.0f, 0.0f, i);
                        i += rate * Time.deltaTime;
                        yield return 0;
                    }
                }
            }
            </pre>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Let's go through the magic here. PerformFading() is a Coroutine where fading is performed. As I said earlier, it needs to be started with the StartCoroutine method.
            <p><span class="glyphicon-remove"></span>You can see that the Coroutine is being invoked by pressing 'F'. When it is executed, it starts to increase the alpha of the image bit by bit every frame until its done. It's almost like it started a parallel exection to fade the screen.</p>
            <p><span class="glyphicon-remove"></span>Here we have calculated the amount to increment for each frame execution, i.e. how much should the alpha be increased, depending upon the given time.</p>
            <p><span class="glyphicon-remove"></span>Thus the alpha will increase a fixed amount every frame and hence create a proper illusion of a fading image.</p>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Next we'll us the WaitForSecond function.
            <pre>
            <span class="glyphicon-remove"></span>public class FadeEffect : MonoBehavior {
                public Image image;

                void Update(){
                    if(Input.GetKeyDown(KeyCode.F)){
                        StartCoroutine(PerformFadingWithIntervals(0.5f));
                    }
                }

                IEnumerator PerformFadingWithIntervals(float time) {
                    float i = 0;

                    while(i <= 1){
                        image.color = new color(0.0f, 0.0f, 0.0f, i);
                        i += 0.2f;
                        yield return new WaitForSeconds(time / 5);
                    }
                }
            }
            </pre>
            <p><span class="glyphicon-remove"></span>Here, execution waits for some time as specified in the funciton and resumes afterwards. It is repeated until Coroutine finishes its execution.</p>
            <p><span class="glyphicon-remove"></span>Let's again take the same example and change yield statement as shown in the code above. After changing in the line of yield, save and play.</p>
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="why-coroutines">
    <h2>Why Coroutines</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            You may be thinking Coroutines work just like Update, so why use Coroutines? Well, Update is generally used for things where something is performed every frame whereas Coroutines are best when you wan to schedule some event.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Take for example a visual effect that happens every couple minutes. Let's say we used it in Update(). How will you handle execution when nothing is to be performed? Even though nothing is to be done, Update will still get called.
            <br>Or, we could use some boolean like "isPlaying"? But the main problem is it's sloppy, since Update()) will needlessly keep checking this long after the desired effect is over. This would be something like calling out someone continuously knowing that no one is going to respond. A waste of precious energy.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            By using Coroutines your code gets shorter and it does help in optimization of code. Coroutines have only a tiny overhead and can be preferred over an Update method that is called all the time needlessly.
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="where-and-when">
    <h2>Where &amp; When</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            Let's look at some situations where using Coroutines could be helpful.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            <h3>1. When you want to sequence things like animations and state machines.</h3>
            <p><span class="glyphicon-remove"></span>Take a look at this code:</p>
            <pre>
            <span class="glyphicon-remove"></span>IEnumerator PerformPlayerMotion() {
                player.ChangeAnimatorState(PlayerAnimator.AnimatorState.Move);
                PlayerControl.RaiseOnChangeCameraMode(CameraScenematic.CameraMode.PlayerMovement);
                Yield return StartCoroutine(player.PerformMovement());
                player.ChangeAnimatorState(PlayerAnimator.AnimatorState.Idle);
                Player.StopNow();
                Yield return new WaitForSeconeds(1.0f);
            }
            </pre>
            <p><span class="glyphicon-remove"></span>Yes this is how sequences are maintatined in games.</p>
            <p><span class="glyphicon-remove"></span>Here, the first animation state is changed, then the camera state is changed, and it waits till the movement of the player is over. As soon as the player movement is over the state is changed back to the idle and respective motion method is called.</p>
            <p><span class="glyphicon-remove"></span>For smoother ending another WaitforSeconds() is set. Now if you check the third line, another coroutine is called; player.PerformMovement(). Yes it is possible. Now by using yield ahead of the StartCoroutine(), this will force the current coroutine to wait until execution of player.PerformMovement() is complete.</p>
            <p><span class="glyphicon-remove"></span>This is how you can handle a sequence in your games. It's not perfect, but a possible solution.</p>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            <h3>2. When you want to split execution over multiple frames.</h3>
            <p><span class="glyphicon-remove"></span>Look at the following code.</p>
            <pre>
            <span class="glyphicon-remove"></span>IEnumerator PerformGridCalculations() {
                for(int i = 0; i < 1000; i++) {
                    for(int j = 0; j < 1000; j++) {
                        grid[i, j].DoSomeExpensiveCalculations()l;
                    }
                    yield return 0;
                }
            }
            </pre>
            <p><span class="glyphicon-remove"></span>Imagine a grid with 1000 x 1000 items and some calculation is to be done for each grid item! That would take a heck of a CPU to get that done smoothly. But luckily, because of Coroutines, there is a possibility that allows you to divide these heavy calculations into multiple frames and resulting in lesser CPU overload.</p>
            <p><span class="glyphicon-remove"></span>As seen in the code above, the execution is divided into parts. Here only the j loop will be executed and cut off until it reaches the next frame. In simpler words, only one loop of execution will be performed for the i loop in a single frame.</p>
            <p><span class="glyphicon-remove"></span>This is how Coroutines can help optimize games.</p>
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            <h3>3. When working on asynchronous code.</h3>
            <p><span class="glyphicon-remove"></span>Have a look at this code:</p>
            <pre>
            <span class="glyphicon-remove"></span>IEnumerator LoginToFacebook() {
                FB.Login();
                while(!FB.isLoggedIn()){
                    yield return null;
                }
                SomeProccessOnLogin();
            }
            </pre>
            <p><span class="glyphicon-remove"></span>Now as shown above if you want to perform some initialization or something like that after an asynchrounous process is complete, then there is no perfect solution other than coroutines.</p>
            <p><span class="glyphicon-remove"></span>Here I want to perform some stuff after login to FB process is completed. So I'll check if FB.isLoggedIn() every frame. As soon as the condition turns true, required action will be executed. Simple as that.</p>
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="whats-new">
    <h2>Whats New</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            Recently, Unity has added some new features to Coroutines which are the WaitUntil and WaitWhile functions. They can only be used with the yield statement.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            1. <b>WaitUntil</b> suspends the execution until the given condition is true.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            2. <b>WaitWhile</b> suspends the execution until the given condition is false.
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="caution">
    <h2>Caution</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            Coroutines create a flow of logic which is incredibly hard to follow as there is no explicity structure in how they execute or in what order.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            You end up creating an implicity dependency between them which varies depending on their execution order. Thus, if not used with proper understanding they can destroy your game structure.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Coroutines do generate a bit of garbage when they are used.
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class="jumbotron col-md-12 heliList" id="comments">
    <h2>Important Comments</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            It is really dangerous to start a coroutine on kepress and not checking to see if it is already running. You should always use flags, which check if the coroutine is already running, otherwise you start it again and again and again...
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            Deactivating your GameObject will kill all Coroutines running on it.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            XXX
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

                    <!-------------------------------------->
                </div>
            </div>
    </main>

    <!-------------------------------------------------------------------------->

    <!-- FOOTER -->
    <footer class="navbar navbar-inverse navbar-fixed-bottom">
        <nav>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <ul>
                            <li>&copy; 2017 <a href="http://www.gabedeyo.com">Gabe Deyo</a></li>
                            <li>|</li>
                            <li><a href="mailto:gabedeyo@gmail.com?subject=Notes">gabedeyo@gmail.com</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </footer>

    <!-- Latest Minified Slim JQuery -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script src="../../js/selection.js" charset="utf-8"></script>
</body>

</html>

<!-- Section Template

<div class="jumbotron col-md-12 heliList" id="">
    <h2>XXX</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            XXX
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            XXX
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            XXX
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

-->
