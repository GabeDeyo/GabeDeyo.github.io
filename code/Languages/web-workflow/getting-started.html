<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Web Workflow</title>

    <meta name="viewport" content="width=device-width,initial-scale=1.0, shrink-to-fit=no" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="../../../css/page.css">
</head>

<body>

    <!-- Top Navigation -->
    <header>
        <nav class="navbar navbar-inverse">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#collapsemenu" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="../../../index.html" class="navbar-brand">Personal Notes</a>
                </div>

                <div class="collapse navbar-collapse" id="collapsemenu">
                    <ul class="nav navbar-nav">

                        <!-- GAME DEVELOMENT -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Game Development <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- CONCEPTS -->
                                <li><a href="../../../game/Categories/concepts.html">Concepts <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- ENGINE -->
                                <li><a href="../../../game/Categories/engine.html">Engine <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- IMPLEMENTATIONS -->
                                <li><a href="../../../game/Categories/implementations.html">Implementations <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                        
                        <!-- PROGRAMMING -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Programming <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- LANGUAGES -->
                                <li><a href="../../Categories/languages.html">Languages <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- ALGORITHMS -->
                                <li><a href="../../Categories/algorithms.html">Algorithms <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- PROBLEMS -->
                                <li><a href="../../Categories/problems.html">Problems <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- RANDOM -->
                                <li><a href="../../Categories/random.html">Random <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                        <!-- GABE DEVELOPMENT -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Gabe Development <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <!-- FITNESS PAGE -->
                                <li><a href="../../../gabe/Categories/fitness.html">Fitness <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- STYLE & GROOMING PAGE -->
                                <li><a href="../../../gabe/Categories/style.html">Style <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- FINANCE PAGE -->
                                <li><a href="../../../gabe/Categories/finance.html">Finance <span class="glyphicon-chevron-right"></span></a></li>

                                <!-- PHILOSOPHY PAGE -->
                                <li><a href="../../../gabe/Categories/philosophy.html">Philosophy <span class="glyphicon-chevron-right"></span></a></li>
                            </ul>
                        </li>

                    </ul>
                </div>

            </div>
        </nav>
    </header>

    <!-------------------------------------------------------------------------->

    <!-- MAIN -->
    <main>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1 id="title">Web Workflow</h1>

                    <aside>
                        <button type="button" class="btn btn-default" name="button" id="selectAll">Select All</button>
                        <button type="button" class="btn btn-default" name="button" id="clearAll">Clear All</button>
                    </aside>

                    <div class="jumbotron heliList">
                        <h2>Index</h2>
                        <ul>
                            <li><p><span class="glyphicon-remove"></span>
                                <a href="#0">Workflow Management</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#1'>Installations</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#2'>Package.json</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#3'>Assets</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#4'>Versioning</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#5'>Gulp</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#6'>Building/Automation</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#7'>Production Build</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#8'>App</a>
                                </p>
                            </li>
                            <li><p><span class='glyphicon-remove'></span>
                                <a href='#9'>Server</a>
                                </p>
                            </li>
                        </ul>
                    </div>

<div class="jumbotron col-md-12 heliList" id="0">
    <h2>Workflow Management</h2>
    <ul>
        <li><p><span class="glyphicon-remove"></span>
            <b>Workflows</b> can help you speed up development, because they automate your processes and help you work faster and more efficiently. They can help automate many different processes and help with the overall deployment of your project.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            What are some of the different workflow <b>tools</b> that we'll take advantage of?
            <br> &nbsp; &bull; Text Editors - provides syntax highlighting, personal customizations, syntax checking, language verification, editor/language extensions, etc.
            <br> &nbsp; &bull; Open Source Build Tools - Tools used to customize your build workflow that will handle virtually any workflow you can dream of.
            <br> &nbsp; &bull; Version Tools - Tools that will help you with project management and versioning.
        </p></li>
        <li><p><span class="glyphicon-remove"></span>
            This <i>"getting started"</i> project will use several workflow tools. 
            <br> &nbsp; &bull; <b>Preprocessor languages</b> - CoffeeScript, Sass and Compass
            <br> &nbsp; &bull; <b>Template language</b> - mustache.js
            <br> &nbsp; &bull; <b>Versioning tools</b> - Git, Github
            <br> &nbsp; &bull; <b>Bundling tool</b> - Browserify
            <br> &nbsp; &bull; <b>JavaScript runtime</b> - Node.js
            <br> &nbsp; &bull; <b>Package Manager</b> - npm
        </p></li>
    </ul>
    <a href="#title"><span class="glyphicon-menu-up"></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='1'>
    <h2>Installations: Software you'll need</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            <a href="https://git-scm.com/" target="_blank">Git</a>
            <br> &nbsp; &bull; Git Bash
            <br> &nbsp; &bull;  Checkout Windows style commit UNIX style endings
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <a href="https://nodejs.org/en/download/" target="_blank">Node.js/NPM</a>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <a href="https://rubyinstaller.org/" target="_blank">Ruby - (Sass &amp; Compass)</a> 
            <br> &nbsp; &bull; Add Ruby executables to your path option
            <br> &nbsp; &bull; MSYS2?
            <br> &nbsp; &bull; Maybe just say fuck it and use npm/node!
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <a href="https://www.npmjs.com/package/gulp">Gulp</a>
            <pre><span class='glyphicon-remove'></span>npm install -g gulp</pre>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='2'>
    <h2>Package.json</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            <b>package.json</b> should be your initial file.
            <br> &nbsp; &bull; It will store <i>basic</i> information about the application. (Name, description, version number, etc.)
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            1. Open terminal at the root of your project.
            <br>2. Run the npm init command
            <br>3. Fill out with default values
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>package.json Defaults (in progress)</h3>
            <pre>
            <span class='glyphicon-remove'></span>{
                "name": "workflow-starter",
                "version": "0.0.1",
                "description": "Simple Workflow Starter Kit",
                "author": "Gabe Deyo",
                "license": "ISC",
                "repository": {
                    "type": "git",
                    "url": "?.git"
                }
            }
            </pre>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='3'>
    <h2>Assets</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Folder Structure Setup</h3>
            <p><span class='glyphicon-remove'></span>1. Create a <b>"Builds"</b> folder at root level
            <br>2. Create a subfolder under Builds named <b>"Development"</b>
            <br>3. Create a subfolder under Builds named <b>"Production"</b>
            <br>4. Create a <b>"Components"</b> folder at root level
            <br>5. Create a subfolder under Components named <b>"Coffee"</b>
            <br>6. Create a subfolder under Components named <b>"SASS"</b>
            <br>7. Create a subfolder under Components named <b>"Scripts"</b></p>
            <p><span class='glyphicon-remove'></span>Development - 
                <br> &nbsp; &bull; Holds the files when we're <i>programming</i> the website. 
                <br> &nbsp; &bull; Holds all assets (json, css, img, etc.).
                <br> &nbsp; &bull; Where the <b>index.html</b> file lives.
            <br>Production - 
                <br> &nbsp; &bull; holds the files when we're <i>ready to upload</i> them to a server.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>JavaScript/Coffee</h3>
            <p><span class='glyphicon-remove'></span>&bull; Put any .coffee files in the <b>coffee</b> folder.
                <br> &nbsp; &bull; For this example we'll create a headline.coffee file here.
            <br>&bull; Put any .js files in the <b>scripts</b> folder.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>CSS/SASS/Compass</h3>
            <p><span class='glyphicon-remove'></span>&bull; Put any .scss files in the <b>SASS</b> folder. 
                <br>&bull; Try to separate variables, mixins, the base, and modules into specific sass files. (_variables.scss, _mixins.scss, etc.)
                <br>&bull; The style.scss file should simply contain <b>imports</b> to the Compass styles, core partials, and js partials.</p>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='4'>
    <h2>Versioning</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            &bull; Use <b>Git</b> to <i>keep track</i> of your project and <i>manage</i> any changes.
            <br>&bull; You'll want to setup a git project before even really starting your project in case you want to track or manage the project early on.
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Git Ignore</h3>
            <p><span class='glyphicon-remove'></span>First you'll need a <b>.gitignore</b> file (at same level as .git) This file will filter out anything you do not want to keep track of.</p>
            <pre>
            <span class='glyphicon-remove'></span>node_modules
            .tmp
            .sass-cache
            builds/**/images/*
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Initialize Git Project</h3>
            <p><span class='glyphicon-remove'></span>1. Open your <b>terminal</b> in your root folder or the project.
            <br>2. git init
            <br>3. git add .
            <br>4. git commit -m "Initial Commit"
            <br>5. git remote add origin &lt;url>
            <br>6. Open project with versioning software, GitHub Desktop, SourceTree, etc.
            <br>7. Push initial changes to <i>master</i> || git push -u origin master
            <br>8. Add README.md if necessary</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Rolling back to commit</h3>
            <p><span class='glyphicon-remove'></span>In order to roll back to a specific commit, type in the terminal <i>"checkout commit_id"</i>.
            <br> &nbsp; &bull; This will put you in a <i>"Detached HEAD"</i> state
            <br> &nbsp; &bull; If you ask <i>"git branch"</i>, the branch will say (detached from 12345)
        <br>&bull; In order to get back to master, simply say <i>"git checkout master"</i></p>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='5'>
    <h2>Gulp</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            Gulp is a <b>build tool</b> that uses the concept of <i>pipes</i>. You take one file, process it through a plug-in, and then send the output of that file to another plug-in.
            <br> &nbsp; &bull; If you haven't already, install Gulp globally - npm install -g gulp
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Gulp Depencencies</h3>
            <p><span class='glyphicon-remove'></span>You should have gulp installed as a developer depencency and install from an npm install or yarn install.
            <br> &nbsp; &bull; Or you could install as a devDependency through CI - npm install --save-dev gulp
            <br> &nbsp; &bull; Or manually add this to your package.json</p>
            <pre>"devDependencies" : {
                "gulp" : "latest",
            }
            </pre>
            <p><span class='glyphicon-remove'></span>You'll also need to <i>npm install --save-dev gulp-util</i> for more functionality using gulp.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Gulp File</h3>
            <p><span class='glyphicon-remove'></span>Create a <i>gulpfile.js</i> at the root of your project.
            <br> &nbsp; &bull; Here you'll setup gulp tasks to call when building, serving, or doing random things with your project.</p>
            <pre>
            <span class='glyphicon-remove'></span>//Gulpfile.js
            
            var gulp = require('gulp'),
                gutil = require('gulp-util');

            gulp.task('log', function() {
                gutil.log('Workflows are awesome');
            });
            </pre>
            <p><span class='glyphicon-remove'></span>&bull; In the terminal, calling <i>"gulp log"</i> would then log "Workflows are awesome" in the terminal and give some information about the task.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Gulp-Coffee Task</h3>
            <p><span class='glyphicon-remove'></span>First you'll need to run: <i>"npm install --save-dev gulp-coffee"</i> in order to run the task on your coffee files.</p>
            <pre>
            <span class='glyphicon-remove'></span>var gulp = require('gulp'),
                guutil = require('gulp-util');
                coffee = require('gulp-coffee');

            //Sources with coffee files
            var coffeeSources = ['components/coffee/*.coffee'];

            // Coffee Task
            gulp.task('coffee', function() {
                // Grab file(s) from this source
                gulp.src(coffeeSources)

                    // Send source files through pipe
                    // Compile the JS without the top-level function safety wrapper
                    .pipe(coffee({bare: true})

                        // On Error, log error in console
                        .on('error', gutil.log))
                    
                    // Send compiled files to destination
                    .pipe(gulp.dest('components/scripts'))
            });
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Combining the JavaScript</h3>
            <p><span class='glyphicon-remove'></span>We're going to want to push all this compiled js code and bring it to the Development folder and combine it all into one central file as well.
            <br>&bull; In order to do that we'll need <b>Gulp-Concat</b>, <i>"npm install --save-dev gulp-concat"</i></p>
            <pre>
            <span class='glyphicon-remove'></span>var gulp = require('gulp'),
                guutil = require('gulp-util'),
                coffee = require('gulp-coffee'),
                concat = require('gulp-concat');

            var coffeeSources = ['components/coffee/*.coffee'];
            //JS Sources
            var jsSources = [
                'components/scripts/script1.js',
                'components/scripts/script2.js',
                'components/scripts/script3.js'
            ];

            gulp.task('coffee', function() {gulp.src(coffeeSources).pipe(coffee({bare: true}).on('error', gutil.log)).pipe(gulp.dest('components/scripts'))});

            //JavaScript Task
            gulp.task('js', function() {
                gulp.src(jsSources)                             // Grabs scripts from jsSources array
                    .pipe(concat('script.js'))                  // Concats all js sources into one js file
                    .pipe(gulp.dest('builds/development/js'))   // Sends concatenated file
            });
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Browserify</h3>
            <p><span class='glyphicon-remove'></span>Say you're using two libraries, jQuery for JSON importing, and Mustache.js for templating. Typically these would get added to the project through libary downloads or CDN. However, we'll use an easier, node.js application, called <b>Browserify</b>, which lets us add libraries as <i>dependencies</i>.
            <br> &nbsp; &bull; Again, we'll need to install Browserify through npm as a dev dependency. <i>"npm install --save-dev gulp-browserify"</i>
            <br> &nbsp; &bull; In this example, we would also need dev dependency installations of jQuery and Mustache. <i>"npm install --save-dev jquery"</i> <i>"npm install --save-dev mustache"</i></p>
            <pre>
            <span class='glyphicon-remove'></span>var gulp = require('gulp'),
                guutil = require('gulp-util'),
                coffee = require('gulp-coffee'),
                concat = require('gulp-concat'),
                browserify = require('gulp-browserify');

            var coffeeSources = ['components/coffee/*.coffee'];
            var jsSources = ['components/scripts/script1.js','components/scripts/script2.js','components/scripts/script3.js'];

            gulp.task('coffee', function() {gulp.src(coffeeSources).pipe(coffee({bare: true}).on('error', gutil.log)).pipe(gulp.dest('components/scripts'))});

            //JavaScript Task
            gulp.task('js', function() {
                gulp.src(jsSources)
                    .pipe(concat('script.js'))
                    .pipe(browserify())
                    .pipe(gulp.dest('builds/development/js'))
            });
            </pre>
            <p><span class='glyphicon-remove'></span>Now in order to use <b>Browserify</b>, you can simply go into the scripts pulling in dependencies, and <i>requiring</i> what you need. This next example looks at a <b>coffee</b> script pulling in <b>jquery</b>.</p>
            <pre>
            <span class='glyphicon-remove'></span>$ = require 'jquery'

            do fill = (item = 'The most creative minds in CS') ->
                $('.tagline').append "#{item}"
            fill
            </pre>
            <p><span class='glyphicon-remove'></span>This would be the same process if you were requiring Mustache in one of your JS files, also we won't need to require jQuery since it's already done in the CoffeeScript component. Template.js:</p>
            <pre>
            <span class='glyphicon-remove'></span>$(function() {
                var Mustache = require('mustache');

                $.getJSON('js/data.json', function(data) {
                    var template = $('#speakerstpl').html();
                    var html = Mustache.to_html(template, data);
                    $('#speakers').html(html);
                }); //getJSON
            }); //function
            </pre>
            <p><span class='glyphicon-remove'></span>You can do other things with Browserify, including loading your own modules with the require statement. So any of these JS files can also be added to other JavaScript files using <i>require</i>.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>SASS / Compass</h3>
            <p><span class='glyphicon-remove'></span>The installation for these components is going to be a bit more intense and we're not using fucking Ruby so don't even ask for it. My personal plan is to build using a nodejs sass/compass component somehow. I'll fill this in later with that process.</p>
            <p><span class='glyphicon-remove'></span>We will need a single plug-in called gulp-compass, <i>"npm install --save-dev gulp-compass"</i></p>
            <pre>
            <span class='glyphicon-remove'></span>var gulp = require('gulp'),
                guutil = require('gulp-util'),
                coffee = require('gulp-coffee'),
                concat = require('gulp-concat'),
                browserify = require('gulp-browserify'),
                compass = require('gulp-compass');

            var coffeeSources = [...];
            var jsSources = [...];

            //SASS Sources - remember everything is filtered through one style.scss file
            var sassSources = ['components/sass/style.scss'];

            //SASS Task
            gulp.task('compass', function() {
                gulp.src(sassSources)
                    .pipe(compass({
                        sass: 'components/sass',
                        image: 'builds/development/images',
                        style: 'expanded'
                    }))
                        .on('error', gutil.log
                    .pipe(gulp.dest('builds/development/css'))
            });
            </pre>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='6'>
    <h2>Building/Automation</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Sequential Tasks</h3>
            One important aspect of gulps build process is that tasks can be run with <i>dependency tasks</i> that are required to run before the current task. So we can essentially have a chain of dependent tasks that run sequentially. To do this, simply add a <i>task array parameter</i> to the task you are working on. Any task in the task array will be run before the current task.
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('js', ['coffee'], function() {
                /*Regular JS task*/
                /*!DONT IMPLEMENT!*/
            })
            </pre>
            <p><span class='glyphicon-remove'></span>For right now, we're going to implement a task that will run through <b>all</b> of our currently implemented tasks <i>without a callback of it's own</i>!</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('all', ['coffee', 'js', 'compass']);
            </pre>
            <p><span class='glyphicon-remove'></span>Running this task will simply run all the task sequentially in it's task array parameter.
            <br> &nbsp; &bull; <i>Note:</i> when this runs the compass task, it's going to find that the css/style.css file hadn't changed so it won't even need to touch it, saving us time.</p>
            <p><span class='glyphicon-remove'></span>For simplicity sake, we'll want to repurpose the "all" task as the "default" task. This allows us to simply call <i>"gulp"</i> in the terminal, and have it call the "default" task.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Watch File Changes</h3>
            <p><span class='glyphicon-remove'></span>Gulp has a special method called <b>watch</b> which can run continuously in the background, and monitor changes to files. Just like other tasks, watch will allow you to do a couple things when files change.</p>
            <p><span class='glyphicon-remove'></span>What we want is another task, "watch", that will monitor and update things when they change.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('watch', function() {
                gulp.watch(coffeeSources, ['coffee']);
                gulp.watch(jsSources, ['js']);

                //Notice it won't see changes in the main sass style file, so we needs the wildcard
                gulp.watch('components/sass/*.sc', ['compass']);
            });
            </pre>
            <p><span class='glyphicon-remove'></span>You'll also want to add this "watch" task to your default task.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('default', ['coffee', 'js', 'compass', 'watch']);
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Reload Browser Automatically</h3>
            <p><span class='glyphicon-remove'></span>The next piece of the beautiful automation puzzle is a single plug-in called gulp-connect. <i>"npm install --save-dev gulp-connect"</i>, which will be responsible for reloading all of your pages.</p>
            <p><span class='glyphicon-remove'></span>This plug-in will actually fix a problem you probably haven't experienced yet. When loading in the data with mustache, your going to encounter an error called a same-domain policy. This means servers don't allow you to load data files unless the files are coming from the same server. The problem is that we're not serving the data file from the server at all, just the local hard drive. However, gulp-connect will automatically fire up a server for you as well.</p>
            <pre>
            <span class='glyphicon-remove'></span>var gulp = require('gulp'),
                guutil = require('gulp-util'),
                coffee = require('gulp-coffee'),
                concat = require('gulp-concat'),
                browserify = require('gulp-browserify'),
                compass = require('gulp-compass'),
                connect = require('gulp-connect');

            gulp.task('connect', function() {
                connect.server({
                    root: 'builds/development/',
                    livereload: true
                });
            });
            </pre>
            <p><span class='glyphicon-remove'></span>We'll also want to throw this task into our default task.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('default', ['coffee', 'js', 'compass', 'connect', 'watch']);
            </pre>
            <p><span class='glyphicon-remove'></span>We'll need to actually <i>reload</i> the page which is called through connect.reload(). Since our js task is the final and most essential core task we have, we'll pipe this call onto that task.</p>
            <pre>
            <span class='glyphicon-remove'></span>//JavaScript Task
            gulp.task('js', function() {
                gulp.src(jsSources)
                    .pipe(concat('script.js'))
                    .pipe(browserify())
                    .pipe(gulp.dest('builds/development/js'))
                    .pipe(connect.reload())
            });
            </pre>
            <p><span class='glyphicon-remove'></span>Unless it becomes a problem, reloading after css/sass changes can be helpful to, and only requires another pipe to do so.</p>
            <pre>
            <span class='glyphicon-remove'></span>//SASS Task
            gulp.task('compass', function() {
                gulp.src(sassSources)
                    .pipe(compass({
                        sass: 'components/sass',
                        image: 'builds/development/images',
                        style: 'expanded'
                    }))
                        .on('error', gutil.log
                    .pipe(gulp.dest('builds/development/css'))
                    .pipe(connect.reload())
            });
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Static Reloads</h3>
            <p><span class='glyphicon-remove'></span>Time to finally add our static HTML watches/reloads.</p>
            <pre>
            <span class='glyphicon-remove'></span>//HTML Sources
            var htmlSources = ['builds/development/*.html'];
            
            //HTML Task
            gulp.task('html', function() {
                gulp.src(htmlSources)
                    .pipe(connect.reload())
            })
            </pre>
            <p><span class='glyphicon-remove'></span>Then add to default task:</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('default', ['html', 'coffee', 'js', 'compass', 'connect', 'watch']);
            </pre>
            <p><span class='glyphicon-remove'></span>Also add to watched sources:</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('watch', function() {
                gulp.watch(coffeeSources, ['coffee']);
                gulp.watch(jsSources, ['js']);
                gulp.watch('components/sass/*.scss', ['compass']);
                gulp.watch(htmlSources, ['html']);
            })
            </pre>
            <p><span class='glyphicon-remove'></span>So the HTML task was very easy, but because we're using a template language to pull in data from a json file, changes in that json file will not trigger a reload on the html side. So we need to add in another task for the json.</p>
            <pre>
            <span class='glyphicon-remove'></span>//JSON Sources
            var jsonSources = ['builds/development/js/*.json'];

            //JSON Task
            gulp.task('json', function() {
                gulp.src('builds/development/js/*.json')
                    .pipe(connect.reload())
            })
            </pre>
            <p><span class='glyphicon-remove'></span>Again we need to add to default and watch tasks:</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('watch', function() {
                gulp.watch(coffeeSources, ['coffee']);
                gulp.watch(jsSources, ['js']);
                gulp.watch('components/sass/*.scss', ['compass']);
                gulp.watch(htmlSources, ['html']);
                gulp.watch(jsonSources, ['json']);
            });

            gulp.task('default', ['html', 'json', 'coffee', 'js', 'compass', 'connect', 'watch']);
            </pre>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='7'>
    <h2>Production Build</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Environment Variables</h3>
            <p><span class='glyphicon-remove'></span>An <b>environment variable</b> is something you can set as part of your computer's processes that can affect the way an application works. Node.js provides a special way of accessing these variables through your application, by a process called process.env. At the top of your gulpfile, just under your gulp plugins, add this variable.</p>
            <pre>
            <span class='glyphicon-remove'></span>var env = process.env.NODE_ENV || 'development';
            </pre>
            <p><span class='glyphicon-remove'></span>This variable will let us actually run tasks and assign variable conditionally. First we'll need to rearrange our variables a little:</p>
            <pre>
            <span class='glyphicon-remove'></span>//Gulp Plug-Ins
            
            //Declare Variables
            var env,
                coffeeSources,
                jsSources,
                sassSources,
                htmlSources,
                jsonSources,
                outputDir;

            env = process.env.NODE_ENV || 'development';

            //Assign Variables
            if(env==='development') {
                outputDir = 'builds/development/';
            } else {
                outputDir = 'builds/production/';
            }

            //Replace 'builds/development/' with outputDir + '...'
            </pre>
            <p><span class='glyphicon-remove'></span>!Important! - Now go through your gulpfile and <b>replace</b> any line in the script that says 'builds/development/' with outputDir and concatonation. This will correctly assign the build source through the conditional env variable. MAKE SURE TO TEST.</p>
            <p><span class='glyphicon-remove'></span>Now in order to run the default command in the production state, your terminal command will look like this:</p>
            <pre>
            <span class='glyphicon-remove'></span>NODE_ENV=production gulp
            </pre>
            <p><span class='glyphicon-remove'></span>We also want to change our sass style through the environmental variables as well since gulp-compass comes with a compression command built in.</p>
            <pre>
            <span class='glyphicon-remove'></span>var env,
                /*...*/,
                sassStyle;

            if(env==='development') {
                outputDir = 'builds/development/';
                sassStyle = 'expanded';
            } else {
                outputDir = 'builds/production/';
                sassStyle = 'compressed';
            }
            </pre>
            <p><span class='glyphicon-remove'></span>Now simply change the <i>compass</i> task to grab that sass variable to conditionally compress or expand.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('compass', function() {
                gulp.src(sassSources)
                    .pipe(compass({
                        sass: 'components/sass',
                        image: outputDir + 'images',
                        style: sassStyle
                    })
                    .on('error', gutil.log))
                    .pipe(gulp.dest(outputDir + 'css'))
                    .pipe(connect.reload())
            });
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Conditional Uglify</h3>
            <p><span class='glyphicon-remove'></span>This section will simply show how to create specific content with another plugin called gulp if. <i>"npm install --save-dev gulp-if"</i>. Also for this section, we'll be running a minifier called Uglify.js. <i>"npm install --save-dev gulp-uglify"</i>. Add these plug-ins</p>
            <pre>
            <span class='glyphicon-remove'></span>gulpif = require('gulp-if');
            uglify = require('gulp-uglify');
            </pre>
            <p><span class='glyphicon-remove'></span>With these plugins, we'll want to conditionally minify our javascript. So let's head to the js task.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('js', function() {
                gulp.src(jsSources)
                    .pipe(concat('script.js'))
                    .pipe(browserify())
                    .pipe(gulpif(env === 'production', uglify())) //Uglifies JS if in production env
                    .pipe(gulp.dest(outputDir + 'js'))
                    .pipe(connect.reload())
            });
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Minifying HTML</h3>
            <p><span class='glyphicon-remove'></span>The next plug-in we'll need is the gulp-minify-html tool. <i>"npm install --save-dev gulp-minify-html"</i>. Add the plug-in.</p>
            <pre>
            <span class='glyphicon-remove'></span>var minifyHTML = require('gulp-minify-html');
            </pre>
            <p><span class='glyphicon-remove'></span>Then we'll work on minifying our html before sending it to production.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('html', function() {
                gulp.src('builds/development/*.html') //Makes sure it's only grabbing from development
                    .pipe(gulpif(env === 'production', minifyHTML()))
                    .pipe(gulpif(env === 'production', gulp.dest(outputDir)))
                    .pipe(connect.reload())
            });
            </pre>
            <p><span class='glyphicon-remove'></span>We also need to go back to our watch task and hard-code the html gulp watch path to the development side.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('watch', function() {
                /*coffee, js, scss*/
                gulp.watch('builds/development/*.html', ['html']);
                /*json*/
            })
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Crushing JSON</h3>
            <p><span class='glyphicon-remove'></span>In order to take care of our JSON, we'll need a plug-in called gulp-jsonminify. <i>"npm install --save-dev gulp-jsonminify"</i></p>
            <pre>
            <span class='glyphicon-remove'></span>var jsonminify = require('gulp-jsonminify');
            </pre>
            <p><span class='glyphicon-remove'></span>Now head down to the json task, we're going to implement more conditional building.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('json', function() {
                gulp.src('builds/development/js/*.json')
                    .pipe(gulpif(env === 'production', jsonminify()))
                    .pipe(gulpif(env === 'production', gulp.dest('builds/production/js')))
                    .pipe(connect.reload())
            })
            </pre>
            <p><span class='glyphicon-remove'></span>Also go back to the watch task to hard code in the path to the develoment json.</p>
            <pre>
            <span class='glyphicon-remove'></span>gulp.task('watch', function() {
                /*coffee, js, scss*/
                gulp.watch('builds/development/*.html', ['html']);
                gulp.watch('builds/development/js/*.json', ['json']);
            })
            </pre>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Compressing Images</h3>
            <p><span class='glyphicon-remove'></span>The last thing you can try and compress a bit is your images, but it can be tricky and some people may want more control. In order to do this you'll need the plug-in gulp-imagemin. <i>"npm install --save-dev gulp-imagemin"</i>. You'll also need the imagemin-pngcrush plug-in to make it work. <i>"npm install --save-dev imagemin-pngcrush"</i></p>
            <p><span class='glyphicon-remove'></span>NOTE: It is not recommended for PC users at this time.</p>
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <h3>Final Gulp.js</h3>
            <pre>
            <span class='glyphicon-remove'></span>var gulp = require('gulp'),
                gutil = require('gulp-util'),
                coffee = require('gulp-coffee'),
                browserify = require('gulp-browserify'),
                compass = require('gulp-compass'),
                connect = require('gulp-connect'),
                gulpif = require('gulp-if'),
                uglify = require('gulp-uglify'),
                minifyHTML = require('gulp-minify-html'),
                jsonminify = require('gulp-jsonminify'),
                concat = require('gulp-concat');

            var env,
                coffeeSources,
                jsSources,
                sassSources,
                htmlSources,
                jsonSources,
                outputDir,
                sassStyle;

            env = process.env.NODE_ENV || 'development';

            if (env==='development') {
            outputDir = 'builds/development/';
            sassStyle = 'expanded';
            } else {
            outputDir = 'builds/production/';
            sassStyle = 'compressed';
            }


            coffeeSources = ['components/coffee/headline.coffee'];
            jsSources = [
            'components/scripts/headline.js',
            'components/scripts/template.js'
            ];
            sassSources = ['components/sass/style.scss'];
            htmlSources = [outputDir + '*.html'];
            jsonSources = [outputDir + 'js/*.json'];

            gulp.task('coffee', function() {
            gulp.src(coffeeSources)
                .pipe(coffee({ bare: true })
                .on('error', gutil.log))
                .pipe(gulp.dest('components/scripts'))
            });

            gulp.task('js', function() {
            gulp.src(jsSources)
                .pipe(concat('script.js'))
                .pipe(browserify())
                .pipe(gulpif(env === 'production', uglify()))
                .pipe(gulp.dest(outputDir + 'js'))
                .pipe(connect.reload())
            });

            gulp.task('compass', function() {
            gulp.src(sassSources)
                .pipe(compass({
                sass: 'components/sass',
                css: '../' + outputDir + 'css',
                image: outputDir + 'images',
                style: sassStyle
                })
                .on('error', gutil.log))
                .pipe(gulp.dest(outputDir + 'css'))
                .pipe(connect.reload())
            });

            gulp.task('watch', function() {
            gulp.watch(coffeeSources, ['coffee']);
            gulp.watch(jsSources, ['js']);
            gulp.watch('components/sass/*.scss', ['compass']);
            gulp.watch('builds/development/*.html', ['html']);
            gulp.watch('builds/development/js/*.json', ['json']);
            });

            gulp.task('connect', function() {
            connect.server({
                root: outputDir,
                livereload: true
            });
            });

            gulp.task('html', function() {
            gulp.src('builds/development/*.html')
                .pipe(gulpif(env === 'production', minifyHTML()))
                .pipe(gulpif(env === 'production', gulp.dest(outputDir)))
                .pipe(connect.reload())
            });

            gulp.task('json', function() {
            gulp.src('builds/development/js/*.json')
                .pipe(gulpif(env === 'production', jsonminify()))
                .pipe(gulpif(env === 'production', gulp.dest('builds/production/js')))
                .pipe(connect.reload())
            });

            gulp.task('default', ['html', 'json', 'coffee', 'js', 'compass', 'connect', 'watch']);
            </pre>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='8'>
    <h2>App</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            In order to get this running on our server, we'll need our project to be a node app. 
            <br>&bull; For this project, we'll simply be serving static files with <i>npm install finalhandler</i> and <i>npm install serve-static</i>.
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            <pre>
            <span class='glyphicon-remove'></span>//app.js

            var finalhandler = require('finalhandler');
            var http = require('http');
            var serveStatic = require('serve-static');

            var serve = serveStatic('./builds/production/, {'index' : ['index.html', 'index.htm']});

            var server = http.createServer(function onRequest(req, res) {
                serve(req, res, finalhandler(req, res));
            });

            server.listen(8080, function() {
                console.log('Server listening on localhost:8080');
            })
            </pre>
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

<div class='jumbotron col-md-12 heliList' id='9'>
    <h2>Server</h2>
    <ul>
        <li><p><span class='glyphicon-remove'></span>
            My current server setup is through Digital Ocean.
            <br>&bull; It's using 512 MB Memmory / 20 GB Disk / NYC3
            <br>&bull; Current Tech - Ubuntu / Git / Npm/Node / NGINX / PM2
        </p></li>
        <li><p><span class='glyphicon-remove'></span>
            &bull; First, clone the project into <i>/var/www/html/</i>
            <br>&bull; Head to <i>/etc/nginx/sites-enables/</i> and <i>sudo nano default</i>
            <br> &nbsp; &bull; make sure the <b>root</b> is /var/www/html
            <br> &nbsp; &bull; location should read this...
            <pre>
            <span class='glyphicon-remove'></span>location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
                proxy_pass http://localhost:8080;
                proxy_http_version 1.1;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection 'upgrade';
                proxy_set_header Host $host;
                proxy_cache_bypass $http_upgrade;
            }
            </pre>
            <br> &nbsp; &bull; Then just below <i>location</i>, make sure this exists...
            <pre>
            <span class='glyphicon-remove'></span>## Serve static files
            location ~ ^/(assets/|images/|img/|downloads/|js/|css/|robots.txt|humans.txt|favicon.ico) {
                root /var/www/html/builds/production;
                access_log off;
                expires max;
            }
            </pre>
            <br>&bull; Stop any apps running through pm2, and run <i>pm2 start app.js</i>
            <br> &nbsp; &bull; Run <i>sudo pm2 startup</i> and finally <i>sudo pm2 save</i> to save pm2 app list
        </p></li>
    </ul>
    <a href='#title'><span class='glyphicon-menu-up'></span></a>
</div>

                    <!-------------------------------------->
                </div>
            </div>
    </main>

    <!-------------------------------------------------------------------------->

    <!-- FOOTER -->
    <footer class="navbar navbar-inverse navbar-fixed-bottom">
        <nav>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <ul>
                            <li>&copy; 2017 <a href="http://www.gabedeyo.com">Gabe Deyo</a></li>
                            <li>|</li>
                            <li><a href="mailto:gabedeyo@gmail.com?subject=Notes">gabedeyo@gmail.com</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </footer>

    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="../../../js/selection.js" charset="utf-8"></script>
</body>

</html>
